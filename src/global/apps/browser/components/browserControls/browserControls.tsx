import React, { useContext } from 'react'
import { CacheContext, DirectoryContext, ThemeContext } from '../../../../../global/context'
import './styles.scss'

const BrowserControls = () => {
    const {
        onCacheManifests,
        onCacheDirectoryPayloads,
        onClearCachedManifests,
        hasCachedManifests,
        clearPayloadCache,
        payloadCacheMap
    } = useContext(CacheContext)

    const { currentDirectory } = useContext(DirectoryContext)

    const { theme } = useContext(ThemeContext)

    return (
        <div className={`browser-controls--${theme.styleName}`}>
            <div className="browser-controls__header">
                <span className="browser-controls__header__text large-text">
                    Browser
                </span>
            </div>
            <div className="browser-controls__buttons">
                <button className="browser-controls__buttons__cache-manifests clickable-item transparent-button" onClick={onCacheManifests}>
                    <span className="browser-controls__buttons__cache-manifests__text no-select medium-text">
                        {`${hasCachedManifests ? "Re-cache" : "Cache"} Manifests`}
                    </span>
                </button>
                <button className={`browser-controls__buttons__clear-manifest-cache clickable-item medium-text ${hasCachedManifests ? "transparent" : "disabled"}-button`} onClick={() => hasCachedManifests && onClearCachedManifests()}>
                    <span className="browser-controls__buttons__clear-manifest-cache__text no-select">
                        Clear Manifest Cache
                    </span>
                </button>
                {currentDirectory && currentDirectory.payloads.length > 0 &&
                    <button className="browser-controls__buttons__cache-payloads clickable-item medium-text transparent-button" onClick={() => onCacheDirectoryPayloads(currentDirectory)}>
                        <span className="browser-controls__buttons__cache-payloads__text">
                            Cache All Payloads in <b>{currentDirectory.name}</b>
                        </span>
                    </button>
                }
                <button className={`browser-controls__buttons__clear-payload-cache clickable-item medium-text ${payloadCacheMap && payloadCacheMap.size > 0 ? "transparent" : "disabled"}-button`} onClick={() => payloadCacheMap && clearPayloadCache()}>
                    <span className="browser-controls__buttons__clear-payload-cache__text no-select">
                        Clear Payload Cache
                    </span>
                </button>
            </div>
        </div>)
}

export default BrowserControls